% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gam_riskfactor.R
\name{riskfactor_gam}
\alias{riskfactor_gam}
\alias{fit_gam}
\title{Generalized Additive Model for Insurance Risk Factors}
\usage{
riskfactor_gam(
  data,
  nclaims,
  x,
  exposure,
  amount = NULL,
  pure_premium = NULL,
  model = "frequency",
  round_x = NULL
)

fit_gam(
  data,
  nclaims,
  x,
  exposure,
  amount = NULL,
  pure_premium = NULL,
  model = "frequency",
  round_x = NULL
)
}
\arguments{
\item{data}{A data.frame containing the insurance portfolio.}

\item{nclaims}{Character, name of column in \code{data} with the number of claims.}

\item{x}{Character, name of column in \code{data} with the continuous risk factor.}

\item{exposure}{Character, name of column in \code{data} with the exposure.}

\item{amount}{(Optional) Character, column name in \code{data} with the claim
amount. Required for \code{model = "severity"}.}

\item{pure_premium}{(Optional) Character, column name in \code{data} with the pure
premium. Required for \code{model = "burning"}.}

\item{model}{Character string specifying the model type. One of
\code{"frequency"}, \code{"severity"}, or \code{"burning"}. Default is \code{"frequency"}.}

\item{round_x}{(Optional) Numeric value to round the risk factor \code{x} to a
multiple of \code{round_x}. Can speed up fitting for factors with many levels.}
}
\value{
A \code{list} of class \code{"fitgam"} with the following elements:
\item{prediction}{A data frame with predicted values and confidence intervals.}
\item{x}{Name of the continuous risk factor.}
\item{model}{The model type: \code{"frequency"}, \code{"severity"}, or \code{"burning"}.}
\item{data}{Merged data frame with predictions and observed values.}
\item{x_obs}{Observed values of the continuous risk factor.}
}
\description{
Fits a generalized additive model (GAM) to a continuous risk factor in one of
three contexts: claim frequency, claim severity, or burning cost (pure premium).

\code{\link[=fit_gam]{fit_gam()}} is deprecated as of version 0.7.6.
Please use \code{\link[=riskfactor_gam]{riskfactor_gam()}} instead.

In addition, note that column arguments must now be passed as \strong{strings}
(standard evaluation).
}
\details{
\itemize{
\item \strong{Frequency model}: Fits a Poisson GAM to the number of claims. The log of
the exposure is used as an offset so the expected number of claims is
proportional to exposure.
\item \strong{Severity model}: Fits a lognormal GAM to the average claim size (total
amount divided by number of claims). The number of claims is included as a
weight.
\item \strong{Burning cost model}: Fits a lognormal GAM to the pure premium (risk
premium). Implemented by aggregating exposure-weighted pure premiums. This
functionality is still experimental.
}
\subsection{Migration from \code{fit_gam()}}{

The function \code{\link[=fit_gam]{fit_gam()}} is deprecated as of version 0.7.6 and replaced by
\code{\link[=riskfactor_gam]{riskfactor_gam()}}. In addition to the name change, the interface has also
changed:
\itemize{
\item \code{fit_gam()} used \strong{non-standard evaluation (NSE)}, so column names could be
passed unquoted (e.g. \code{x = age_policyholder}).
\item \code{riskfactor_gam()} uses \strong{standard evaluation (SE)}, so column names must
be passed as character strings (e.g. \code{x = "age_policyholder"}).
}

This makes the function easier to use in programmatic workflows.

\code{fit_gam()} is still available for backward compatibility but will emit a
deprecation warning and will be removed in a future release.
}
}
\examples{
## --- Recommended new usage (SE) ---
# Column names must be passed as strings
riskfactor_gam(MTPL,
               nclaims = "nclaims",
               x = "age_policyholder",
               exposure = "exposure")

## --- Deprecated usage (NSE) ---
# This still works but will show a warning
fit_gam(MTPL,
        nclaims = nclaims,
        x = age_policyholder,
        exposure = exposure)

}
\references{
Antonio, K. and Valdez, E. A. (2012). Statistical concepts of a
priori and a posteriori risk classification in insurance. Advances in
Statistical Analysis, 96(2):187–224.

Henckaerts, R., Antonio, K., Clijsters, M. and Verbelen, R.
(2018). A data driven binning strategy for the construction of insurance
tariff classes. Scandinavian Actuarial Journal, 2018:8, 681–705.

Wood, S.N. (2011). Fast stable restricted maximum likelihood and
marginal likelihood estimation of semiparametric generalized linear models.
Journal of the Royal Statistical Society (B) 73(1):3–36.
}
\author{
Martin Haringa
}
