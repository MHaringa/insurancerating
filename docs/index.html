<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analytic Insurance Rating Techniques • insurancerating</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Analytic Insurance Rating Techniques">
<meta property="og:description" content="Methods for insurance rating. It provides a data driven strategy for the construction of 
    insurance tariff classes. This strategy is based on the work by Antonio and Valdez (2012) &lt;doi:10.1007/s10182-011-0152-7&gt;.
    The package also adds functionality showing additional lines for the reference 
    categories in the levels of the coefficients in the output of a generalized linear regression analysis. 
    In addition it implements a procedure determining the level of a factor with the largest exposure, 
    and thereafter changing the base level of the factor to this level. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">insurancerating</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette.html">Introduction to `insurancerating`</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mharinga/insurancerating">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="insurancerating" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#insurancerating" class="anchor"></a>insurancerating</h1></div>
<!-- badges: start -->

<p>The goal of insurancerating is to give analytic techniques that can be used in insurance rating. It provides a data driven strategy for the construction of tariff classes in P\&amp;C insurance. The goal is to bin the continuous factors such that categorical risk factors result which capture the effect of the covariate on the response in an accurate way, while being easy to use in a generalized linear model (GLM).</p>
<p>It also adds functionality showing additional lines for the reference categories in the levels of the coefficients in the output of a generalized linear regression analysis. In addition it implements a procedure determining the level of a factor with the largest exposure, and thereafter changing the base level of the factor to this level.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install insurancerating from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"insurancerating"</span>)</a></code></pre></div>
<p>Or the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"MHaringa/insurancerating"</span>)</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows the techniques provided in insurancerating.</p>
<p>The first part shows how to fit a GAM for the variable <em>age_policyholder</em> in the MTPL dataset:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(insurancerating)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Claim frequency </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">age_policyholder_frequency &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_gam.html">fit_gam</a></span>(<span class="dt">data =</span> MTPL, </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                                      <span class="dt">nclaims =</span> nclaims, </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                                      <span class="dt">x =</span> age_policyholder, </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">                                      <span class="dt">exposure =</span> exposure)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co"># Claim severity </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">age_policyholder_severity &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_gam.html">fit_gam</a></span>(<span class="dt">data =</span> MTPL, </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                                     <span class="dt">nclaims =</span> nclaims, </a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                                     <span class="dt">x =</span> age_policyholder, </a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                                     <span class="dt">exposure =</span> exposure, </a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                                     <span class="dt">amount =</span> amount, </a>
<a class="sourceLine" id="cb3-17" data-line-number="17">                                     <span class="dt">model =</span> <span class="st">"severity"</span>)</a></code></pre></div>
<p>Create plot:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(age_policyholder_frequency, <span class="dt">show_observations =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="reference/figures/plotgam-1.png"><!-- --></p>
<p>Determine classes for the claim frequency (the points show the ratio between the observed number of claims and exposure for each age):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">clusters_freq &lt;-<span class="st"> </span><span class="kw"><a href="reference/construct_tariff_classes.html">construct_tariff_classes</a></span>(age_policyholder_frequency)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">clusters_sev &lt;-<span class="st"> </span><span class="kw"><a href="reference/construct_tariff_classes.html">construct_tariff_classes</a></span>(age_policyholder_severity)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(clusters_freq, <span class="dt">show_observations =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="reference/figures/figfreq-1.png"><!-- --></p>
<p>The figure shows that younger policyholders have a higher risk profile. The fitted GAM is lower than might be expected from the observed claim frequency for policyholders of age 19. This is because there are very few young policyholders of age 19 present in the portfolio.</p>
<p>Show classes for the claim severity:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">age_policyholder_severity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/construct_tariff_classes.html">construct_tariff_classes</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(., <span class="dt">show_observations =</span> <span class="ot">TRUE</span>, <span class="dt">remove_outliers =</span> <span class="dv">100000</span>)</a></code></pre></div>
<p><img src="reference/figures/figsev-1.png"><!-- --></p>
<p>The second part adds the constructed tariff classes for the variable <em>age_policyholder</em> to the dataset, and sets the base level of the factor <em>age_policyholder</em> to the level with the largest exposure. In this example for claim frequency the class for ages (39,50], which contains the largest exposure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">dat &lt;-<span class="st"> </span>MTPL <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">age_policyholder_freq_cat =</span> clusters_freq<span class="op">$</span>tariff_classes) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">age_policyholder_sev_cat =</span> clusters_sev<span class="op">$</span>tariff_classes) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span>(is.character, as.factor) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span>(is.factor, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="op">~</span><span class="kw"><a href="reference/biggest_reference.html">biggest_reference</a></span>(., exposure)))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(dat)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">## Observations: 32,731</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">## Variables: 6</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">## $ age_policyholder          &lt;int&gt; 43, 21, 54, 44, 20, 38, 68, 45, 76, 30, 28,…</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">## $ nclaims                   &lt;int&gt; 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0…</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">## $ exposure                  &lt;dbl&gt; 1.0000000, 1.0000000, 1.0000000, 1.0000000,…</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">## $ amount                    &lt;dbl&gt; 0, 0, 0, 57540, 2057, 0, 0, 6510, 0, 0, 0, …</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">## $ age_policyholder_freq_cat &lt;fct&gt; "(39,50]", "[18,25]", "(50,57]", "(39,50]",…</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">## $ age_policyholder_sev_cat  &lt;fct&gt; "(39,46]", "[18,25]", "(46,81]", "(39,46]",…</span></a></code></pre></div>
<p>The last part is to fit a <em>generalized linear model</em>. The function rating_factors prints the output including the reference group.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(nclaims <span class="op">~</span><span class="st"> </span>age_policyholder_freq_cat, <span class="dt">offset =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(exposure), <span class="dt">family =</span> <span class="st">"poisson"</span>, <span class="dt">data =</span> dat)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="reference/rating_factors.html">rating_factors</a></span>(model)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">##                         term     cluster  estimate</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">## 1                  Intercept (Intercept) 0.1368181</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">## 2  age_policyholder_freq_cat     (39,50] 1.0000000</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">## 3  age_policyholder_freq_cat     [18,25] 1.9438228</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">## 4  age_policyholder_freq_cat     (25,32] 1.3234995</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">## 5  age_policyholder_freq_cat     (32,39] 1.0568538</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">## 6  age_policyholder_freq_cat     (50,57] 0.8919696</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">## 7  age_policyholder_freq_cat     (57,64] 0.7423998</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">## 8  age_policyholder_freq_cat     (64,71] 0.7379362</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">## 9  age_policyholder_freq_cat     (71,83] 0.7021348</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">## 10 age_policyholder_freq_cat     (83,95] 0.6933378</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=insurancerating">https://​cloud.r-project.org/​package=insurancerating</a>
</li>
<li>Browse source code at <br><a href="https://github.com/mharinga/insurancerating">https://​github.com/​mharinga/​insurancerating</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Martin Haringa <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=insurancerating"><img src="https://www.r-pkg.org/badges/version/insurancerating" alt="CRAN Status"></a></li>
<li><a href="https://cran.rstudio.com/package=insurancerating"><img src="https://cranlogs.r-pkg.org/badges/insurancerating?color=blue" alt="Downloads"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Martin Haringa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
