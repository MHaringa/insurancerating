<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized additive model — fit_gam • insurancerating</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized additive model — fit_gam"><meta name="description" content="Fits a generalized additive model (GAM) to continuous risk
factors in one of the following three types of models: the number of reported
claims (claim frequency), the severity of reported claims (claim severity)
or the burning cost (i.e. risk premium or pure premium)."><meta property="og:description" content="Fits a generalized additive model (GAM) to continuous risk
factors in one of the following three types of models: the number of reported
claims (claim frequency), the severity of reported claims (claim severity)
or the burning cost (i.e. risk premium or pure premium)."><meta property="og:image" content="https://mharinga.github.io/insurancerating/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">insurancerating</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/mharinga/insurancerating/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generalized additive model</h1>
      <small class="dont-index">Source: <a href="https://github.com/mharinga/insurancerating/blob/HEAD/R/gam_fit.R" class="external-link"><code>R/gam_fit.R</code></a></small>
      <div class="d-none name"><code>fit_gam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a generalized additive model (GAM) to continuous risk
factors in one of the following three types of models: the number of reported
claims (claim frequency), the severity of reported claims (claim severity)
or the burning cost (i.e. risk premium or pure premium).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_gam</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">nclaims</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">exposure</span>,</span>
<span>  amount <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pure_premium <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"frequency"</span>,</span>
<span>  round_x <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data.frame of an insurance portfolio</p></dd>


<dt id="arg-nclaims">nclaims<a class="anchor" aria-label="anchor" href="#arg-nclaims"></a></dt>
<dd><p>column in <code>data</code> with number of claims</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>column in <code>data</code> with continuous risk factor</p></dd>


<dt id="arg-exposure">exposure<a class="anchor" aria-label="anchor" href="#arg-exposure"></a></dt>
<dd><p>column in <code>data</code> with exposure</p></dd>


<dt id="arg-amount">amount<a class="anchor" aria-label="anchor" href="#arg-amount"></a></dt>
<dd><p>column in <code>data</code> with claim amount</p></dd>


<dt id="arg-pure-premium">pure_premium<a class="anchor" aria-label="anchor" href="#arg-pure-premium"></a></dt>
<dd><p>column in <code>data</code> with pure premium</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>choose either 'frequency', 'severity' or 'burning'
(model = 'frequency' is default). See details section.</p></dd>


<dt id="arg-round-x">round_x<a class="anchor" aria-label="anchor" href="#arg-round-x"></a></dt>
<dd><p>round elements in column <code>x</code> to multiple of <code>round_x</code>. This
gives a speed enhancement for data containing many levels for <code>x</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components</p>
<dl><dt>prediction</dt>
<dd><p>data frame with predicted values</p></dd>

<dt>x</dt>
<dd><p>name of continuous risk factor</p></dd>

<dt>model</dt>
<dd><p>either 'frequency', 'severity' or 'burning'</p></dd>

<dt>data</dt>
<dd><p>data frame with predicted values and observed values</p></dd>

<dt>x_obs</dt>
<dd><p>observations for continuous risk factor</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The 'frequency' specification uses a Poisson GAM for fitting the
number of claims. The logarithm of the exposure is included as an offset,
such that the expected number of claims is proportional to the exposure.</p>
<p>The 'severity' specification uses a lognormal GAM for fitting the average
cost of a claim. The average cost of a claim is defined as the ratio of the
claim amount and the number of claims. The number of claims is included as a
weight.</p>
<p>The 'burning' specification uses a lognormal GAM for fitting the pure
premium of a claim. The pure premium is obtained by multiplying the estimated
frequency and the estimated severity of claims. The word burning cost is
used here as equivalent of risk premium and pure premium. Note that the
functionality for fitting a GAM for pure premium is still experimental (in
the early stages of development).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Antonio, K. and Valdez, E. A. (2012). Statistical concepts of a
priori and a posteriori risk classification in insurance. Advances in
Statistical Analysis, 96(2):187–224. doi:10.1007/s10182-011-0152-7.</p>
<p>Grubinger, T., Zeileis, A., and Pfeiffer, K.-P. (2014). evtree:
Evolutionary learning of globally optimal classification and regression trees
in R. Journal of Statistical Software, 61(1):1–29. doi:10.18637/jss.v061.i01.</p>
<p>Henckaerts, R., Antonio, K., Clijsters, M. and Verbelen, R.
(2018). A data driven binning strategy for the construction of insurance
tariff classes. Scandinavian Actuarial Journal, 2018:8, 681-705.
doi:10.1080/03461238.2018.1429300.</p>
<p>Wood, S.N. (2011). Fast stable restricted maximum likelihood and
marginal likelihood estimation of semiparametric generalized linear models.
Journal of the Royal Statistical Society (B) 73(1):3-36.
doi:10.1111/j.1467-9868.2010.00749.x.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Martin Haringa</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">fit_gam</span><span class="op">(</span><span class="va">MTPL</span>, nclaims <span class="op">=</span> <span class="va">nclaims</span>, x <span class="op">=</span> <span class="va">age_policyholder</span>,</span></span>
<span class="r-in"><span>exposure <span class="op">=</span> <span class="va">exposure</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            x  predicted     lwr_95    upr_95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   18.00000 0.33683705 0.21781040 0.5209081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   18.77778 0.32218997 0.21698662 0.4783999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   19.55556 0.30817998 0.21568460 0.4403416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   20.33333 0.29478165 0.21372588 0.4065779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   21.11111 0.28197418 0.21093250 0.3769426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   21.88889 0.26974205 0.20717072 0.3512117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   22.66667 0.25807532 0.20239831 0.3290683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   23.44444 0.24696930 0.19669877 0.3100875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   24.22222 0.23642372 0.19028011 0.2937573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  25.00000 0.22644165 0.18343007 0.2795388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  25.77778 0.21702844 0.17644700 0.2669433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  26.55556 0.20819044 0.16958063 0.2555908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  27.33333 0.19993360 0.16300468 0.2452288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  28.11111 0.19226234 0.15681941 0.2357158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  28.88889 0.18517864 0.15107034 0.2269878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  29.66667 0.17868117 0.14577063 0.2190219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  30.44444 0.17276468 0.14091962 0.2118061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  31.22222 0.16741962 0.13651454 0.2053212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  32.00000 0.16263204 0.13255476 0.1995340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  32.77778 0.15838349 0.12904044 0.1943990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  33.55556 0.15465092 0.12596792 0.1898651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  34.33333 0.15140695 0.12332514 0.1858831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  35.11111 0.14862005 0.12108853 0.1824113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  35.88889 0.14625487 0.11922234 0.1794168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  36.66667 0.14427229 0.11768048 0.1768730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  37.44444 0.14262987 0.11641068 0.1747544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  38.22222 0.14128239 0.11535995 0.1730298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  39.00000 0.14018239 0.11447950 0.1716561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  39.77778 0.13928082 0.11372806 0.1705748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  40.55556 0.13852786 0.11307267 0.1697136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  41.33333 0.13787411 0.11248705 0.1689907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  42.11111 0.13727167 0.11194807 0.1683237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  42.88889 0.13667536 0.11143197 0.1676373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  43.66667 0.13604407 0.11091147 0.1668717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  44.44444 0.13534205 0.11035510 0.1659866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  45.22222 0.13453992 0.10972876 0.1649612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  46.00000 0.13361546 0.10899937 0.1637908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  46.77778 0.13255422 0.10813962 0.1624809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  47.55556 0.13134973 0.10713267 0.1610410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  48.33333 0.13000323 0.10597508 0.1594794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  49.11111 0.12852296 0.10467710 0.1578010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  49.88889 0.12692325 0.10326012 0.1560090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  50.66667 0.12522346 0.10175212 0.1541090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  51.44444 0.12344655 0.10018246 0.1521130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  52.22222 0.12161762 0.09857760 0.1500427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  53.00000 0.11976256 0.09695867 0.1479297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  53.77778 0.11790690 0.09534118 0.1458135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  54.55556 0.11607463 0.09373643 0.1437362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  55.33333 0.11428738 0.09215413 0.1417365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  56.11111 0.11256383 0.09060508 0.1398444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  56.88889 0.11091931 0.08910266 0.1380777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  57.66667 0.10936563 0.08766282 0.1364414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  58.44444 0.10791109 0.08630242 0.1349302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  59.22222 0.10656065 0.08503682 0.1335324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  60.00000 0.10531631 0.08387718 0.1322353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  60.77778 0.10417745 0.08282849 0.1310291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  61.55556 0.10314121 0.08188883 0.1299092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  62.33333 0.10220313 0.08105032 0.1288765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  63.11111 0.10135754 0.08030133 0.1279350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  63.88889 0.10059811 0.07962946 0.1270884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  64.66667 0.09991824 0.07902461 0.1263360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  65.44444 0.09931152 0.07848142 0.1256702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  66.22222 0.09877204 0.07800040 0.1250752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  67.00000 0.09829468 0.07758724 0.1245288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  67.77778 0.09787524 0.07725078 0.1240060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  68.55556 0.09751063 0.07700007 0.1234846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  69.33333 0.09719881 0.07684142 0.1229494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  70.11111 0.09693873 0.07677604 0.1223965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  70.88889 0.09673020 0.07679874 0.1218344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  71.66667 0.09657374 0.07689774 0.1212843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  72.44444 0.09647024 0.07705556 0.1207766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  73.22222 0.09642076 0.07725076 0.1203478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  74.00000 0.09642621 0.07745955 0.1200370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74  74.77778 0.09648712 0.07765661 0.1198838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  75.55556 0.09660332 0.07781429 0.1199292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  76.33333 0.09677375 0.07790047 0.1202195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77  77.11111 0.09699627 0.07787574 0.1208114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78  77.88889 0.09726760 0.07769195 0.1217756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  78.66667 0.09758320 0.07729414 0.1231980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  79.44444 0.09793730 0.07662748 0.1251733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  80.22222 0.09832305 0.07564773 0.1277953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  81.00000 0.09873263 0.07433108 0.1311448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  81.77778 0.09915751 0.07267893 0.1352829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  82.55556 0.09958874 0.07071599 0.1402500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  83.33333 0.10001728 0.06848345 0.1460711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  84.11111 0.10043439 0.06603031 0.1527642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  84.88889 0.10083198 0.06340585 0.1603494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  85.66667 0.10120300 0.06065455 0.1688587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  86.44444 0.10154181 0.05781385 0.1783438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  87.22222 0.10184440 0.05491416 0.1888817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  88.00000 0.10210858 0.05198048 0.2005784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  88.77778 0.10233412 0.04903472 0.2135685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  89.55556 0.10252277 0.04609792 0.2280129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  90.33333 0.10267806 0.04319190 0.2440917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  91.11111 0.10280433 0.04033996 0.2619916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  91.88889 0.10290626 0.03756567 0.2818982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97  92.66667 0.10298930 0.03489104 0.3039977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98  93.44444 0.10305920 0.03233509 0.3284728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99  94.22222 0.10312138 0.02991252 0.3555039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 95.00000 0.10318029 0.02763269 0.3852745</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Haringa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

